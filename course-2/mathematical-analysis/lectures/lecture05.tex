%\documentclass[a4paper]{article}
%\usepackage{../header}
%\begin{document}



\newpage
\section{Лекция 5}

\subsection{Теорема Вейерштрасса о непрерывной функции на компакте}
\theorem Пусть $K\in \R^n$ — компакт и функция $f: K\mapsto \R$ - непрерывная. Тогда $f$ на $K$ достигает наибольшее и наименьшее значения.

\proof
\begin{itemize}
    \item \textit{Ограниченность.} От противного: пусть существует последовательность $\{x^k\} \subset K \,:\, |f(x^k)| > k$. Из ограниченности $K$ следует ограниченность последовательности $\{x^k\}$, и как следствие ограничены последовательности отдельных коордиант:
    \begin{equation*}
        |x_i^k| = \sqrt{|x_i^k|^2} \leqslant \sqrt{\sum_{i=1}^n|x_i^k|^2} = ||x^k|| \leqslant C \quad \text{для некоторого }C
    \end{equation*}

    По теореме Больцано-Вейерштрасса у $\{x_1^k\}$ существует сходящаяся подпоследовательность $x_1^{k_{j_1}} \to a_1, j_1 \to \infty$. Для последовательности $\{x_2^{k_{j_1}}\}$ существует сходящаяся последовательность $x_2^{k_{j_2}} \to a_2, j_2 \to \infty$. И т.д. Получаем сходящуюся подпоследовательность:
    \begin{equation*}
        x^{k_j} = (x_1^{k_j}, x_2^{k_J}, \ldots, x_n^{k_j})\to(a_1, a_2, \ldots, a_n) = a
    \end{equation*}

    Точка $a$ — предельная для $K$. В силу замкнутости $K$ т. $a\in K$. А из непрерывности функции $f$ получаем $f(x^{k_j}) \to f(a)$. А с другой стороны, $f(x^{k_j})\to\infty$ из выбора исходной последовательности. \textbf{противоречие}

    \item \textit{Достижение наибольшего (наименьшего) значения.} Итак, мы доказали, что $f$ — ограничена на $K$. Выберем последовательность $\{x^k\}$:
    \begin{equation*}
        \sup_K f - \frac{1}{k_j} \le f(x^{k_j}) \le \sup_K f
    \end{equation*}
    в силу непрерывности $f$:
    \begin{equation*}
        \sup_K f \le f(a) \le \sup_K f
    \end{equation*}
    Получаем $f(a) = \displaystyle\sup_K f$, т.е. максимальное значение достиигается в точке $x = a$. Для $\displaystyle\inf_K f$ доказательство аналогично
    \qed
\end{itemize}
\subsection{Расстояние между двумя множествами}
\definition Расстоянием между двумя множествами $X$ и $Y$, где $X, Y \subset \R^n$ будем называть число $\rho(X, Y)$:
\begin{equation*}
    \rho(X, Y) = \inf_{\substack{x\in X\\y\in{Y}}} ||x-y||
\end{equation*}

\textbf{Примеры:}\\
\begin{enumerate}
    \item $X\cap Y \ne \varnothing \implies \rho(X, Y) = 0$
    \item $\rho(X, Y) =0 \implies X \cap Y \ne \varnothing?$ --- нет, пример: $X = (0, 1); (Y = (1; 2)$ - не компакты
\end{enumerate}

\subsection{Расстояние между непересекающимися компактами}
\theorem Если $K_1, K_2 \subset \R^n$ — компакты и $K_1 \cap K_2 = \varnothing$, то $\rho(K_1, K_2)$ > 0

\proof Функция $f(x,y)=||x-y||$ определена на $K_1\times K_2 \subset \R^n\times\R^n = \R^{2n}$, причем $f$–непрерывная функция.

По теореме Вейерштрасса эта функция достигает своего максимального и минимального значений. Т.е. существуют $x_0 \in K_1, y_0 \in K_1: f(x_0, y_0) = \rho(K_1, K_2)$. А $f(x_0,y_0) = 0$ тогда и только тогда, когда $x_0 = y_0$. \qed

\subsection{Колебание функции на множестве}
\definition Колебанием функции $f$ на множестве $M\subset \R^n$ будем называть число $\omega(f, M)$:
\begin{equation*}
    \omega(f, M) = \sup_{x, y\in M}|f(x) - f(y)| = \sup_{x\in M} - \inf_{y\in M} f(y)
\end{equation*}

\subsection{Колебание функции в точке}
\definition Колебанием функции $f$ в точке $x_0 \in M \subset\R^n$ будем называть число
\begin{equation*}
    \omega(f, x_0):= \lim_{r \to 0+} \omega(f, B_r^M(x_0)), \quad \text{где } B_r^M = B_r(x_0)\cap M
\end{equation*}

\textbf{Напоминание:} По определению, функция $f: M\to \R$ непрерывна в точке $x_o\in M$, если $\forall \ve > 0\,\, \exists\delta > 0: \forall x\in M \quad |x-x_0| < \delta\,\, \iff x\in B_{\delta}(x_0) \cap M$ верно $|f(x) - f(x_0)| < \ve$

\subsection{Колебание функции, непрерывной в точке}
\theorem Пусть $x_0 \in M \subset \R^n; \,\, f: M\mapsto\R$. $f$ — непрерывна в точке $x_0 \iff \omega(f, x_0) = 0$

\proof
\begin{itemize}
    \item \textit{Необходимость}\\

        $f$ — непрерывна в т. $x_0 \in M \implies \forall \ve > 0 \,\, \exists\delta > 0:\,\, \forall x \in B_{\delta}(x_0)\cap M = B_{\delta}^M(x_0) \implies |f(x) - f(x_0)| < \frac{\ve}{3}$\\
        Рассмотрим $\omega(f, x_0) := \displaystyle\lim_{\delta\to0+} \omega(f, B_{\delta}^M(x_0))$:
        \begin{equation*}
            \begin{aligned}
                \omega(f, B_{\delta}^M(x_0)) = \sup_{x, y \in B_{\delta}(x_0)}|f(x) - f(y)| \le \sup_{x\in B_{\delta}(x_0)} |f(x) - f(x_0)| + \sup_{y\in B_{\delta}(x_0)} |f(y) - f(x_0)| \le \frac{2\ve}{3} < \ve
            \end{aligned}
        \end{equation*}
        При $\ve\to0 \implies \delta\to0$ и $\omega(f, B_{\delta}^M(x_0))\to0$, т.е. $\omega(f, x_0) = 0$

    \item \textit{Достаточность}

        Пусть $0 = \omega(f, x_0) := \displaystyle\lim_{\delta\to0+} \omega(f, B_{\delta}^M(x_0))$, т.е.
        \begin{equation*}
            \forall \ve > 0 \,\, \exists\delta > 0: \quad \forall x, y \in B_{\delta}^M(x_0) \quad \sup_{x, y\in B_{\delta}^M(x_0)} |f(x)-f(y)| < \ve
        \end{equation*}
        Получаем, что
        \begin{equation*}
            \forall \ve > 0 \,\, \exists \delta > 0: \forall x \in B_{\delta}^M(x_0) \implies |f(x)-f(x_0)| < \ve \implies
        \end{equation*}
\end{itemize}\qed


\definition Если какое-то свойство не выполняется лишь на множестве меры нуль, то говорят, что это свойство выполняется почти всюду.

\textbf{Пример:} $f(x) = \begin{cases}
        1, x \in \R\backslash \mathbb{Z}\\
        0, x \in \mathbb{Z}
    \end{cases}$ --- непрерывна почти всюду на $\R$

\subsection{Пересечение разбиений бруса}
\definition Пусть $\T_1 = \{I^1_k\}$ и $\T_2 = \{I^2_m\}$ — два разбиения бруса $I \subset \R^n$.

Пересечением разбиений $(\T_1 \cap \T_2)$ будем называть мн-во всех брусов $\{I_{ij}\}: \forall I_{ij}$
$\begin{cases}
    1) \exists k: I_{ij} \in \{I^1_k\}\\
    2) \exists m: I_{ij} \in \{I^2_m\}\\
    3) \{I_{ij}\} - \text{ разбиение бруса } I
\end{cases}$

\subsection{Критерий Лебега об интегрируемости функции по Риману}
\theorem Если $I\subset \R^n$ — замкнутый невырожденный брус, $f: I\to\R$, то $f\in R(I) \iff f$ ограничена и непрерывна почти всюду на $I$

\proof
\begin{itemize}
    \item \textit{Необходимость}

     Если $f$ интегрируема, то она ограничена по необходимому условию интегрируемости. Осталось показать, что множества разрыва меры нуль. От противного: пусть это не так.

    Обозначим множество всех точек разрыва ф-ии $f$ на $I$ за $T$ и заметим, что $T = \displaystyle\bigcup_{k\in\mathbb{N}}T_k$, где\\
    $T_k = \{x\in I | \omega(f, x) \ge \frac{1}{k}\}$. Если $T$ не меры нуль, то существует $T_{k_0}$ не меры нуль (если они все меры нуль, то по свойству множеств меры нуль счетное объединение таких множеств тоже было бы меры нуль).

    Для произвольного разбиения $\T = \{I_i\}_{i=1}^m$ бруска $I$ разобъем эти бруски на две кучи: первая $A = \{I_i | I_i\cap T_{k_0} \ne \varnothing, \omega(f, I_i) \ge \frac{1}{2k_0}\}$ и вторая $B = \T\backslash A$. Покажем что $A$ является покрытием множества $T_{k_0}$, т.е. $T_{k_0} \subset \displaystyle\bigcup_{i: I_i\in A} I_i$ любая точка $x\in T_{k_0}$ является либо
    \begin{itemize}
        \item[a)] внутренней для некоторого бруска $I_i$. В этом случае $\omega(f, I_i) \ge \omega(f, x) \ge \frac{1}{k_0} > \frac{1}{2k_0}$, т.е. $I_i \in A$, либо
        \item[b)] точка $x$ лежит на границе некоторого количества брусков (не более чем $2^n$ штук). Тогда хотя бы на одном из них колебание $\omega(f, I_i) \ge \frac{1}{2k_0}$ (т.е. $I_i \in A$): если бы такого не нашлось, то в любой малой окрестности $B_{\ve}(x)$ выполняется следующее:
        \begin{equation*}
            \omega(f, x) \le \sup_{x', x''\in B_{\ve}(x)} |f(x')-f(x'')| \le \sup_{x'\in B_{\ve}(x)}|f(x')-f(x)| + \sup_{x''\in B_{\ve}(x)}|f(x)-f(x'')| < \frac{1}{2k_0} + \frac{1}{2k_0} = \frac{1}{k_0}
        \end{equation*}
        т.е. $x\not\in T_{k_0}$ --- \textbf{противоречие}.
    \end{itemize}

    Таким образом, каждая точка $x\in T_{k_0}$ покрывается некоторым бруском $I_i \in A$, т.е. $A$ - покрытие $T_{k_0}$. Тогда существует $c: \displaystyle\sum_{i:I_i\in A}|I_i| \ge c > 0$ для всех разбиений $\T$ (если бы меняя разбиения мы могли получить сумму объемов этих брусков сколь угодно маленькую, то получилось бы, что $T_{k_0}$ меры нуль)

    Возьмем два набора отмеченных точек $\xi^1$ и $\xi^2$. На брусках из кучки $B$ будем их брать одинаковыми, т.е. для $I_i\in B \,\, \xi_i^1 = \xi_i^2$. А на брусках из кучки $A$ будем брать такие, чтобы
    \begin{equation*}
        f(\xi_i^1) - f(\xi_i)^2 \ge \frac{1}{3k_0} \text{ (у нас там колебания} \ge 1/2k_0, \text{ так что такие найдутся)}
    \end{equation*}

    Получаем:
    \begin{equation*}
        \begin{aligned}
            |\sigma(f, \T, \xi^1) - \sigma(f, \T, \xi^2)
            = \left|\sum_i(f(\xi_i^1) - f(\xi_i^2))|I_i|\right|\\
            = \left|\sum_{i: I_i\in A}(f(\xi_i^1) - f(\xi_i^2))|I_i| + \sum_{i:I_i\in B}(f(\xi_i^1) - f(\xi_i^2))|I_i|\right|\\
            = \left|\sum_{i: I_i\in A} (f(\xi_i^1) - f(\xi_i^2))|I_i|\right| \ge \frac{1}{3k_0} \sum_{i:I_i\in A}|I_i| \ge \frac{c}{3k_0} > 0
        \end{aligned}
    \end{equation*}
    т.е. интегральные суммы не могут стремиться к одному и тому же числу, значит $f$ не интегрируема --- \textbf{противоречие}.

    \item \textit{Достаточность}

    Для любого $\ve > 0$ рассмотрим $T_{\ve} = \{x\in I| \omega(f, x) \ge \ve\}$. Покажем, что это множество - компакт. Ограниченность очевидна (подмножества бруска), а замкнутость проверим от противного. Пусть $a$ - предельная точка $T_{\ve}: \,\, a\not\in T_{\ve}$. Т.к. она предельная, то существует $\{x^k\}: x^k \in B_{\frac{1}{k}}(a)$. Т.к. $B_{\frac{1}{k}}$ - открытые шары, то наши точки лежат в них с окрестностями, т.е. сущесвтуют $\delta_k : B_{\delta_k}(x_K) \subset B_{\frac{1}{k}}(a)$. Тогда
    \begin{equation*}
        \omega(f, B_{\frac{1}{k}}(a)) \ge \omega(f, B_{\delta_k}(x_K)) \ge \omega(f, x_k) \ge \ve
    \end{equation*}
    Переходя к пределу $k\to\infty : \omega(f, a) \ge \ve$, т.е. $a\in T_{\ve}$ - противоречие. Значит $T_{\ve}$ - замкнуто, и, следовательно, компактно.

    Множество $T_{\ve}$ - множество меры нуль (как подмножество множества меры нуль). Значит, его можно покрыть не более чем счетным объединением открытых брусков $I_i: \displaystyle\sum_i|I_i| < \ve$. Т.к. это открытое покрытие, а $T_{\ve}$ - компакт, то существует конечное подпокрытие: $T_{\ve} \subset \displaystyle\bigcup_{i=1}^m I_i$, при этом $\displaystyle\sum_{i=1}^m |I_i| < \ve$.

    Обозначим три множества: $C_1 = \displaystyle\bigcup_{i=1}^mI_i, \quad C_2 = \displaystyle\bigcup_{i=1}^mI_i', C_3 = \displaystyle\bigcup_{i=1}^mI_i''$, где $I_i', I_i''$ - бруски, полученные гомотетией с центром в центре $I_i$ с коэффициентом 2 и 3 соответственно.

    Заметим, что
    \begin{itemize}
        \item[a)] $|C_3| \le \displaystyle\sum_{i=1}^m|I_i''|| = 3^n \displaystyle\sum_{i=1}^m|I_i| < 3^n \ve$
        \item[b)] расстояние $\rho(\partial C_2, \partial C_3) = \delta_1 > 0$ (теорема про расстояние между компактами)
        \item[c)] Множество $K = I\backslash(C_2\backslash \partial C_2)$ - компакт. Кстати, любое множество с диаметром меньше $\delta_1$ либо польностью лежит в $C_3$, либо полностью в $K$.
        \item[d)] $T_{\ve} \cap K = \varnothing$, т.к. $T_{\ve} \subset C_1 \subset C_2$. Следовательно, $\forall x\in K \,\, \omega(f, x) < \ve$. Тогда по теореме Кантора-Гейне $\exists \delta_2 > 0: \,\, \forall x\in K \,\, \omega(f, B_{\delta_2}(x)) < \ve + \ve = 2\ve$
    \end{itemize}

    Выберем $\delta = \min\{\delta_1, \delta_2\}$. Тогда для любых разбиений $\T_1 = \{I_k^1\}, \T_2 = \{I_i^2\}: \lambda{\T_1} < \delta, \lambda(\T_2) < \delta$

    Рассмотрим пересечение этих разбиений $\T = \T_1 \cap \T_2$, т.е. такое разбиение $\T = \{I_{ik}\}$, что $I_k^1 = I_{i_1k} \bigsqcup\ldots\bigsqcup I_{i_mk}$ и $I_i^2 = I_{ik_1} \bigsqcup \ldots\bigsqcup I_{ik_l}$. Очевидно $\lambda(\T) < \delta$.

    Для произвольных наборов отмеченных точек:
    \begin{equation*}
        |\sigma(f, \T_1, \xi^1) - \sigma(f, \T_2, \xi^2)| \le |\sigma(f, \T_1, \xi^1) - \sigma(f, \T, \xi)| + |\sigma(f, \T_2, \xi^2) - \sigma(f, \T, \xi)|
    \end{equation*}

    Рассмотрим отдельное слагаемое:
    \begin{equation*}
        \begin{aligned}
            |\sigma(f, \T_1, \xi^1) - \sigma(f, \T, \xi)| = \left|\sum_{i, j}(f(\xi_i^1) - f(\xi_{ij}))|I_{ij}\right|\
            \le \sum_{I_{ij}\in C_3}|f(\xi_i^1) - f(\xi_{ij})||I_{ij}| + \sum_{I_{ij\in K}}|f(\xi_i^1)-f(\xi_{ij})||I_{ij}|\le 2M\cdot e^n\ve + 2\ve |I| = \epsilon(2M\cdot 3^n + 2|I|)
        \end{aligned}
    \end{equation*}
    т.к. $f$ ограничена некоторой константой $M$ и см пункты $a), d)$, то

    Т.к. для $(\T_2, \xi^2)$ все выкладки аналогичные, то получаем:

    \begin{equation*}
         |\sigma(f, \T_1, \xi^1) - \sigma(f, \T, \xi)| \le \epsilon(2M\cdot 3^n + 2|I|)
    \end{equation*}

        Следовательно, существует предел $\displaystyle\lim_{\lambda(\T)\to0}\sigma(f, \T, \xi)$ (Критерий коши для функций)
\end{itemize} \qed

\subsection{Измельчение разбиения}
\definition Разбиение $\T_1 = \{I^1_k\}$ будем называть измельчением разбиения $\T_2 = \{I^2_m\}$, если $\forall k \,\, \exists m: I_k^1 \in I_m^2 \implies \T = \T_1\cap \T_2$ является измельчением $\T_1$ и $\T_2$



%\end{document}
